---
layout: page
title: ElasticSearch
---

# Installation

Elastic, Kibana, Sense (plugin pour Kibana)

# ElasticSearch

 * Démarrer : `sudo service elasticsearch start`
 * Puis : `http://localhost:9200`
 * Puis : `kibana-4.3.1-linux-x64/bin/kibana`
 * Puis : `http://localhost:5601`
 * Le fichier de configuration elasticsearch est sur


# Répertoires

`curl "localhost:9200/_nodes/settings?pretty=true"`

donne :

- "conf" : `/etc/elasticsearch`
- "data" : `/var/lib/elasticsearch`
- "logs" : `/var/log/elasticsearch`
- "home" : `/usr/share/elasticsearch`




## Exemples


Envoyer un fichier bulk `curl -XPOST localhost:9200/_bulk --data-binary "@jats.json"`

###Search


{% highlight json %}
GET /nationallizenzen/article/_search
{
  "fields" : ["Journal.Volume.Issue.Article.ArticleInfo.ArticleHistory.OnlineDate.Year.value", "Journal.Volume.Issue.Article.ArticleInfo.ArticleTitle.value", "Journal.JournalInfo.JournalTitle.value"],
  "query" : {
    "match_phrase" : {
      "Journal.JournalInfo.JournalElectronicISSN.value" : "1793-7078"
    }
  }
}
{% endhighlight %}

Multifield avec filter

{% highlight json %}
GET /all/_search
{
  "query" : {
    "filtered" : {
      "query": {
        "bool": {
          "must": [
            { "match": { "pyear": 1981   }},
            { "match": { "abstract": "ebola"   }}
          ]
        }
      }
    }
  }
}
{% endhighlight %}


Avec range

{% highlight json %}
GET /springer/article/_search
{
  "query" : {
    "range" : {
      "Journal.Volume.Issue.IssueInfo.IssueHistory.CoverDate.Year.value" : {
        "lte" : 2005
      }
    }
  }
}
{% endhighlight %}



{% highlight json %}
GET /springer/article/_search
{
  "size" : 200,
  "fields" : ["Journal.Volume.Issue.Article.ArticleInfo.ArticleHistory.OnlineDate.Year.value", "Journal.Volume.Issue.Article.ArticleInfo.ArticleTitle.value", "Journal.JournalInfo.JournalTitle.value","Journal.Volume.Issue.Article.ArticleHeader.AuthorGroup.Affiliation.OrgName.value"],
  "query" : {
    "match" : {
      "Journal.Volume.Issue.Article.ArticleHeader.AuthorGroup.Affiliation.OrgName.value" : "Geneva"
    }
  }
}
{% endhighlight %}


Trouver un document ou le champ journalspin existe

{% highlight json %}
GET /springer/article/_search
{
    "query" : {
        "filtered" : {
            "filter" : {
                "exists" : { "field" : "Journal.JournalInfo.JournalSPIN.value" }
            }
        }
    }
}
{% endhighlight %}


###Aggregate simple

{% highlight json %}
GET /nationallizenzen/article/_search?search_type=count
{
  "aggs" : {
    "years_agg" : {
      "terms" : {
        "field" : "Journal.Volume.Issue.Article.ArticleInfo.ArticleHistory.OnlineDate.Year.value"
      }
    }
  }
}
{% endhighlight %}

###Aggregate complex (two buckets)

{% highlight json %}
GET /nationallizenzen/article/_search?search_type=count
{
  "fields": [
    "Journal.JournalInfo.JournalTitle.value"
  ],
  "aggs": {
    "journal_agg": {
      "terms": {
        "field": "Journal.JournalInfo.JournalID.value"
      },
      "aggs" : {
        "years" : {
          "terms" : {
            "field" : "Journal.Volume.Issue.IssueInfo.IssueHistory.CoverDate.Year.value"
          }
        }
      }
    }
  }
}
{% endhighlight %}


###Aggregate with metrics (one bucket + two metrics)

Il faut avoir les années avec un mapping de type integer (ou short)

{% highlight json %}
GET /springer/article/_search?search_type=count
{
  "aggs": {
    "journal_agg": {
      "terms": {
        "field": "Journal.JournalInfo.JournalTitle.value"
      },
      "aggs" : {
        "min_year" : {"min" : { "field" : "Journal.Volume.Issue.IssueInfo.IssueHistory.CoverDate.Year.value"}},
        "max_year" : {"max" : { "field" : "Journal.Volume.Issue.IssueInfo.IssueHistory.CoverDate.Year.value"}}

      }
    }
  }
}
{% endhighlight %}



###Faire des stats sur la présence des champs :

{% highlight json %}
GET /nationallizenzen/_field_stats?fields=Journal.Volume.Issue.IssueInfo.IssueHistory.CoverDate.Year.value,Journal.Volume.Issue.Article.ArticleInfo.ArticleDOI.value,Journal.Volume.Issue.Article.OutputMedium
{% endhighlight %}


###Chercher les documents ou deux champs sont manquants :

{% highlight json %}
GET /springer2/article/_search
{
  "query": {
    "filtered": {
      "query": {
        "match_all": {}
      },
      "filter": {
        "bool": {
          "must": [{
            "missing": {
              "field": "Journal.JournalInfo.JournalPrintISSN.value"
            }
          }, {
            "missing": {
              "field": "Journal.JournalInfo.JournalElectronicISSN.value"
            }
          }]
        }
      }
    }
  }
}
{% endhighlight %}


### Pour un journal id : avoir le titre le plus courant, le pissn et le eissn le plus courant avec les années

{% highlight json %}
GET /springer2/article/_search?search_type=count
{
    "aggs": {
        "journal_agg": {
            "terms": {
                "field": "Journal.JournalInfo.JournalID.value",
                "size" : 10000
            },
            "aggs": {
                "title_agg": {
                    "terms": {
                        "field": "Journal.JournalInfo.JournalTitle.value",
                        "size": 1
                    }
                },
                "eissn_agg": {
                    "terms": {
                        "field": "Journal.JournalInfo.JournalElectronicISSN.value",
                        "size": 1
                    }
                },
                "pissn_agg": {
                    "terms": {
                        "field": "Journal.JournalInfo.JournalPrintISSN.value",
                        "size": 1
                    }
                },
                "min_year" : {"min" : { "field" : "Journal.Volume.Issue.IssueInfo.IssueHistory.CoverDate.Year.value"}},
                "max_year" : {"max" : { "field" : "Journal.Volume.Issue.IssueInfo.IssueHistory.CoverDate.Year.value"}},
                "number_of_years" : {"cardinality" : { "field" : "Journal.Volume.Issue.IssueInfo.IssueHistory.CoverDate.Year.value"}}

            }
        }
    }
}
{% endhighlight %}


### Pour un journal id : avoir le titre le plus courant, le pissn et le eissn le plus courant avec les années

En plus avec les buckets vides aussi retournés (par exemple quand il n'y a jamais de pissn) via `min_doc_count`

{% highlight json %}
GET /springer2/article/_search?search_type=count
{
    "aggs": {
        "journal_agg": {
            "terms": {
                "field": "Journal.JournalInfo.JournalID.value",
                "size" : 10000
            },
            "aggs": {
                "title_agg": {
                    "terms": {
                        "field": "Journal.JournalInfo.JournalTitle.value",
                        "min_doc_count": 0,
                        "size": 1
                    }
                },
                "eissn_agg": {
                    "terms": {
                        "field": "Journal.JournalInfo.JournalElectronicISSN.value",
                        "min_doc_count": 0,
                        "size": 1
                    }
                },
                "pissn_agg": {
                    "terms": {
                        "field": "Journal.JournalInfo.JournalPrintISSN.value",
                        "min_doc_count": 0,
                        "size": 1
                    }
                },
                "min_year" : {"min" : { "field" : "Journal.Volume.Issue.IssueInfo.IssueHistory.CoverDate.Year.value"}},
                "max_year" : {"max" : { "field" : "Journal.Volume.Issue.IssueInfo.IssueHistory.CoverDate.Year.value"}},
                "number_of_years" : {"cardinality" : { "field" : "Journal.Volume.Issue.IssueInfo.IssueHistory.CoverDate.Year.value"}}

            }
        }
    }
}
{% endhighlight %}


### Répartition par années avec un filtre supplémentaire (bucket filter)

{% highlight json %}
GET /springer/article/_search?search_type=count
{
  "aggs": {
    "year_agg": {
      "terms": {
        "field": "Journal.Volume.Issue.IssueInfo.IssueHistory.CoverDate.Year.value",
        "size": 10000
      },
      "aggs" : {
        "my_filter_bucket" : {  "filter": { "terms" : { "Journal.JournalInfo.JournalID.value": [12645,40100,40681,40473,40072,40269,40357,40691]  } }}
     }
    }
  }
}
{% endhighlight %}

### Répartition par années avec un filtre supplémentaire (bucket filter)

Idem mais avec un boolean filter en plus, car sinon la liste des journal id's est trop longue !

{% highlight json %}

GET /springer/article/_search?search_type=count
{
  "aggs": {
    "year_agg": {
      "terms": {
        "field": "Journal.Volume.Issue.IssueInfo.IssueHistory.CoverDate.Year.value",
        "size": 10000
      },
      "aggs": {
        "my_filter_bucket": {
          "filter": {
            "bool": {
              "should": [
                {
                  "terms": {
                    "Journal.JournalInfo.JournalID.value": [12513,13130,12665,11999,11504,11671,13277,11954,11471,40042,11502,12496,11623,40064,11734,11472,11980,11490,12517,13197,13660,11986,40014,13369,11487,11509,11475,11700,12541,11470,12562,10068,11947,10273,11508,13213,11505,11756,12686,12462,11585,11439,12262,718,12508,11739,13662,12614,11498,13312,11801,11478,11501,11826,12648,12594,503,11474,11548,12161,11547,11492,11428,11979,12289,11497,12479,12603,12274,11604,13663,11696,12471,11978,501,12654,12275,12555,11489,13187,11468,12503,13546,11476,13360,12598,12204,12666,12426,506,11982,13661,11491,11983,3,40702,738,11295,12613,11536,11418,11486,11494,11485,11493,11306,12001,12024,13595,13765,11307,11981,11972,40112,12239,11488,10118,11590,11955,12663,13065,719,11377,11560,735,12259,11621,13391,11783,11760,11535,11987,11499,11424,11480,11964,12490,11976,13131,11552,12480,11573,12088,12015,12201,12583,11507,11974,13238,13224,13280,13181,13321,11496,11510,11832,12664,11953,11959,12072,12481,12268,12155,12265,13592,11740,11977,11515,11481,11821,40242,12192,11422,11467,12170,11684,11464,12264,12209,12104,13258,10033,11705,13170,11465,11725,12328,40664,12105,12225,11714,11985,12182,11600,13353,12175,11949,11477,40368,12404,12439,11686,12605,13593,11469,12288,13341,12632,12467,11785,12157,11704,11950,608,11708,12254,11754,12519,13188,11967,13752,12260,11956,11701,12263,12052,12250,12500,11707,12245,11706,12200,12571,11420,11970,5,11961,11553,11958,12449,11460,12501,12399,11825,13760,13629,12181,12608,11690,11969,11503,11709,11506,11827,11962,13126,40195,12212,11757,11764,11772,11984,11828,11839,13244,12671,12639,12612,40670,12410,12649,11819,12306,12483,13314,40011,13204,740,40319,12975,11884,11678,12195,13594,13580,11888,13149,11483,11658,11703,13726,13193,40009,11720,11829,12267,12298,12576,11710,11458,11687,12506,40699,12202,11575,13218,11899,12599,11365,11523,10100,739,12003,715,12285,11482,13205,13199,12558,13191,13355,13296,11784,12290,11554,11682,11816,11440,12601,40430,12646,550,13410,11495,12053,13538,13328,13568,11571,11975,12494,13550,11608,11755,13139,12559,11692,12604,11479,11639,11963,13225,13744,12083]
                  }
                },
                {
                  "terms": {
                    "Journal.JournalInfo.JournalID.value": [13351,11625,12273,12005,12194,13142,11966,13344,13370,13304,12570,12928,11562,12415,11988,12369,11759,11823,12281,11786,11659,12187,13382,12611,13273,12178,13042,13278,11572,11957,11461,11869,12079,12652,11711,11355,11419,13337,13398,13536,11694,13198,16024,11952,40271,12678,12539,12892,13206,11334,13315,13613,13541,40408,11292,13226,40820,12258,533,13329,11965,11973,40295,13143,11971,13412,12232,12633,10436,12574,12631,11628,12080,13346,11968,13533,11587,11558,730,13770,13530,10261,12308,12687,13164,13402,11657,13639,40037,11466,11617,12647,13140,12247,12286,13239,13366,13632,40010,11990,12008,13335,12398,40299,11416,11412,12450,13279,40718,11516,12152,13320,11569,11751,12145,12304,13393,12207,13168,13691,40333,12597,40962,11326,11944,741,12672,13089,12284,12609,13127,12560,12591,12593,13531,13644,12682,13566,12348,13380,40005,40313,13540,40653,12548,40620,13132,11417,12240,13340,13640,12349,13534,708,12607,13374,12193,12592,12525,13596,40502,12602,13201,12078,40094,13348,11634,13545,13659,11459,13347,144,11463,40032,11789,12452,12520,12544,13330,40415,41106,596,13222,11693,40555,11370,12668,13319,13163,40003,12127,13679,12551,12651,12151,13272,12002,40096,12004,12312,13367,13730,12392,11500,12402,13749,11761,11943,12293,12307,12403,13202,13300,11525,12310,13399,40314,13631,40277,13637,11462,11787,40031,40095,40145,40534,11989,12082,40097,12534,11782,12518,40098,40565,41239,11846,40211,40089,40529,40732,12543,35,12595,40336,12198,12552,12688,13196,13386,13561,12042,12280,12451,12667,13237,13539,13636,40477,12156,11579,12572,40092,11409,13670,13668,40510,11457,12154,12685,40134,13235,40792,10013,12241,40658,12371,13753,40435,12186,13349,35834,11403,11702,13021,11800,12061,12076,40140,40300,40306,40065,40840,13174,12530,13219,40030,11301,13669,11868,12588,13129,12065,13570,40169,41045,40324,40954,12095,40739,13203,13209,11698,13291,12561,11369,12030,12159,12301,12393,40803,12133,13671,40137,40436,13705,12354,13665,40069,40090,40353,12062,11568,13194,11473,40329,40622,11812,13165,13385,11721,12553,40843,11838,12326,40615,40710,13721,12469,13171,13324,40136]
                  }
                },
                {
                  "terms": {
                    "Journal.JournalInfo.JournalID.value": [40171,12177,12567,40684,13758,12063,13571,40091,40093,40494,13389,13537,10037,40141,13177,40071,11296,13673,40305,13555,40348,40544,40121,40139,40884,13358,40062,40647,13735,40685,40124,40468,40846,11610,40176,40543,40789,12376,12532,40138,40723,40643,40656,13717,40142,13677,40135,40174,13408,40318,40490,13295,40068,40593,40617,40645,40808,40173,40472,13588,40429,11537,12394,40635,12213,40309,40533,40034,13317,13748,40033,40345,13137,40572,40629,40815,13162,13373,13563,40304,12146,13230,40175,13688,15035,40496,40501,40556,40571,40621,40505,40508,40879,12087,40012,40152,40601,40243,40474,40475,40521,40489,40858,12626,13676,13731,40563,40663,13392,40163,40506,40553,12615,40547,731,11619,13388,40590,40821,40632,12689,40471,40484,40822,12645,40100,40681,40473,40072,40269,40357,40691,40730,40870,13740,40580,12573,40119,40595,40712,40902,40509,40878,12465,12927,40323,40467,40692,40745,40538,13520,13617,40070,40497,40517,40801,11519,13547,40008,40172,40192,40693,40504,40574,40707,11853,40495,40626,40327,40616,40830,13243,40570,40634,12356,35714,40648,40798,40891,40955,13228,13612,13675,40204,40614,40706,40737,10351,13635,40122,40123,40320,40819,13116,40518,40609,40687,40722,12523,40203,40507,40488,40831,11611,13590,40120,40316,40405,40537,40680,40729,12171,13322,40352,40558,40806,40944,40362,40562,40743,40746,40961,13616,40594,40598,40690,40735,41105,12566,13362,40573,40677,40899,40993,40167,40719,40750,40857,40980,40196,40539,40604,40675,41095,40294,40410,40461,40674,40825,40903,40247,40602,40638,40841,41039,13119,40322,40503,40636,40641,40852,40981,40411,40554,40778,12180,13554,40649,40515,40561,40588,40613,40708,12618,40483,40486,40536,40550,40711,40807,40864,40366,40485,40589,40725,40728,40790,40800,40972,40493,40516,40742,40828,40854,40930,40607,40726,40865,41025,13689,40610,40698,40744,40782,40797,40812,40888,41063,40038,40165,40736,40741,40847,40953,40535,40682,40753,40244,40816,40839,40863,40874,40881,40901,40948,41020,40540,40166,40679,40703,40869,10289,13556,13678,40860,13727,40487,40552,40668,40984,41048,11559,40551,40934,41059,40689,40868,41027,40321,40655,40890,41061,11813,13535,40751,40873,41030,40759,40887,40931,41056,40469,40818,40837,40883,40894,40896,40933,40956,40627,40660,40817,40871,40872,40979,41066,40835,40836,40855,40932,40958,41029,40527,40838,40957,40669,40866,41070,41205,40482,40875,40747,41120]
                  }
                }
              ]
            }
          }
        }
      }
    }
  }
}
{% endhighlight %}

### Le nombre d'article des journaux springer qui font partie du contrat

{% highlight json %}
GET /springer/article/_search?search_type=count
{
  "query": {
    "range": {
      "Journal.Volume.Issue.IssueInfo.IssueHistory.CoverDate.Year.value": {
        "lte" : 2004
      }
    }
  },
  "filter": {
    "bool": {
      "should": [
        {
          "terms": {
            "Journal.JournalInfo.JournalID.value": [261, 12188, 40596, 12129, 769,10440, 10441, 592, 236, 11511,10474, 10114, 10255, 707, 701,401, 12242, 12656, 12658, 10488,10450, 376, 10444, 10451, 10459,10, 10453, 266, 10437, 11357,12126, 40520, 10460, 10457, 146,10469, 12, 453, 10464, 12103,10465, 12246, 12230, 726, 10470,10476, 216, 429, 12247, 11565,40768, 40769, 40770, 10231, 12160,10439, 11881, 10455, 277, 10472,12149, 10479, 10480, 10434, 12243,10463, 10482, 10495, 200, 12010,10485, 10443, 10489, 723, 10483,245, 253, 339, 340, 10484,12380, 10499, 10452, 10498, 27,13, 12361, 10502, 407, 153,205, 419, 10505, 11831, 403,244, 404, 203, 402, 12272,10508, 204, 705, 10503, 11512,10506, 10462, 10490, 10690, 10511,10509, 11293, 10512, 13313, 10515,10514, 10516, 395, 10519, 265,10528, 10526, 10532, 10531, 10533,10535, 422, 12011, 374, 10539,10527, 10534, 449, 12257, 10529,10542, 10537, 10543, 11857, 10546,11068, 10548, 12282, 10549, 12228,12357, 40771, 10064, 128, 10517,12366, 12034, 11538, 574, 445,12362, 223, 10092, 526, 10555,10552, 280, 262, 13146, 270,10557, 10562, 10569, 441, 12013,10565, 18, 10571, 10570, 10556,10553, 10593, 10600, 49, 12395,10560, 10566, 10578, 10583, 381,11769, 11631, 11655, 343, 10337,412, 10577, 34, 382, 10584,10238, 10585, 10286, 12016, 10067,10615, 10608, 396, 493, 10573,220, 10597, 580, 10588, 37,10614, 10598, 466, 10589, 10606,607, 10602, 10601, 365, 10591,12397, 40688, 11007, 161, 410,338, 10611, 10609, 10612, 11013,294, 284, 12391, 12144, 10559,10616, 10582, 10645, 10203, 13524,10617, 10623, 427, 125, 10624,10620, 454, 10626, 10619, 446,10633, 12629, 12627, 40772, 40773,12628, 10638, 455, 10643, 11038,11284, 12231, 10160, 10644, 199,10646, 10639, 10648, 10649, 11423,202, 10140, 10663, 181, 10664,10672, 12020, 12022, 366, 10651,10640, 10641, 12665, 10653, 254,267, 10666, 10661, 11356, 10670,12237, 10681, 13385, 405, 406,249, 787, 12365, 217, 421,10096, 228, 13318, 10654, 10342,10657, 259, 394, 590, 431,10658, 238, 10680, 10212, 68,10344, 10610, 330, 586, 10353,10682, 10493, 10686, 221, 11340,348, 10347, 10691, 601, 10692,10694, 10695, 10494, 10697, 12224,12223]
          }
        },
        {
          "terms": {
            "Journal.JournalInfo.JournalID.value": [165, 10703, 10010, 12277, 10701,10702, 10699, 10688, 12147, 10714,10722, 10709, 10708, 367, 10711,39, 11290, 10706, 10715, 10717,10719, 40752, 417, 373, 10726,10728, 380, 10741, 231, 10730,10152, 10734, 10990, 418, 107,10745, 439, 12110, 10746, 12659,10743, 10750, 10040, 10751, 10228,13093, 11584, 11583, 40754, 40755,40756, 40757, 40758, 40760, 40761,40762, 11539, 40763, 11542, 40764,11543, 11544, 251, 12026, 11626,11627, 12291, 12070, 12098, 12055,15010, 10753, 11, 10787, 10755,40, 11251, 20, 10794, 12124,134, 10780, 10272, 10793, 11294,10778, 420, 11153, 10447, 11196,547, 12529, 484, 599, 12521,10147, 384, 11263, 10758, 13158,531, 10696, 10704, 182, 12029,10762, 414, 10766, 10989, 10767,10764, 10769, 10770, 10772, 10771,10798, 12138, 10773, 10765, 10774,10776, 10792, 264, 11159, 10797,192, 11255, 222, 10158, 10637,11581, 40774, 40775, 40776, 11845,10795, 271, 11856, 13160, 10835,11854, 10838, 10802, 10804, 12111,10806, 10801, 540, 10800, 12190,10808, 12387, 10811, 10812, 10813,10816, 10814, 10815, 12036, 10874,10803, 10817, 10864, 10865, 10863,775, 10867, 11373, 10858, 12038,774, 10869, 10551, 432, 11771,10870, 10886, 12039, 10821, 10826,357, 10875, 10877, 10880, 10876,11852, 10900, 359, 360, 10827,11390, 10820, 10822, 10603, 10879,10823, 145, 10824, 10882, 10883,10884, 12040, 10831, 10887, 712,10659, 11664, 10836, 13270, 40618,10665, 10891, 10164, 191, 10834,10896, 10693, 10895, 10310, 11676,41, 10894, 10899, 535, 11606,10897, 12041, 190, 12220, 22,10898, 136, 10732, 10901, 11596,10847, 10781, 10295, 10545, 10904,10905, 12384, 10846, 10844, 10845,12122, 10849, 10909, 10914, 10911,773, 10850, 135, 11665, 12386,10853, 10855, 10854, 10856, 499,285, 10910, 10851, 10958, 12206,10912, 10916, 232, 10913, 239,10735, 109, 894, 12031, 10974,10922, 702, 722, 415, 11060,10921, 332, 10919, 12350, 10926,10872, 10957, 10336, 56, 776,10933, 11092, 10340, 10928, 11669,10992, 344, 10265, 11896, 10965,10924, 148, 12546, 10934, 11123,10936, 10862, 10389, 10940, 10967,10942, 11149, 10943, 11166, 10946,10956, 10972, 10915, 10971, 10953,10955, 10947, 10948, 10952, 11747,11746, 10739, 12524, 10959, 10973,11630, 11666, 11239, 10963, 10964,167, 11814, 11546, 40765, 40766,10980, 423, 10579, 10103, 10978,10982, 11545, 40767, 11005, 10985,10988, 11745, 10986, 10991, 408,10994, 10590, 138, 10334, 335,229, 227, 11001, 11002, 11527,11003, 11004, 186, 11006, 10107,13394, 498, 208, 209, 11018,11012, 11029]
          }
        },
        {
          "terms": {
            "Journal.JournalInfo.JournalID.value": [11517, 795, 430, 12032, 11011,11041, 11661, 11663, 11015, 12540,11016, 703, 11022, 184, 248,604, 542, 12363, 32, 11023,10230, 126, 710, 11024, 11027,11036, 11039, 11010, 12373, 11033,12033, 11032, 11030, 11037, 438,12035, 40592, 706, 605, 11031,11045, 530, 11042, 11046, 572,11069, 11049, 11050, 11053, 114,210, 11059, 11061, 521, 11063,11064, 10072, 11062, 11065, 234,11055, 10143, 11056, 354, 30,11071, 48, 11075, 211, 10705,11695, 10236, 442, 11079, 64,11082, 291, 11282, 11083, 11084,65, 198, 11085, 12542, 436,11089, 246, 467, 247, 383,10998, 424, 11094, 11095, 11096,11406, 11098, 11120, 11110, 269,12600, 11104, 299, 11240, 11258,11130, 10725, 11103, 11105, 606,425, 11090, 11088, 300, 11077,11109, 289, 11111, 10144, 11113,11540, 11118, 11106, 10749, 12043,10329, 440, 12044, 12388, 13271,11125, 709, 11126, 426, 11336,213, 11127, 10240, 12109, 24,11133, 11135, 11136, 11134, 411,11141, 11144, 11145, 11241, 11148,12215, 40777, 12210, 766, 11158,163, 433, 11162, 11165, 11164,12045, 25, 11142, 11147, 10058,11151, 11156, 10290, 11160, 397,296, 603, 11172, 11185, 11182,12046, 11191, 11948, 11192, 29,233, 11228, 11199, 497, 11195,193, 11202, 256, 11187, 355,11205, 11211, 127, 11218, 12115,11219, 11204, 11207, 11188, 11841,38, 11214, 281, 10260, 362,11222, 477, 11223, 158, 11224,11200, 11225, 12116, 11212, 11217,520, 595, 276, 464, 10712,11229, 11230, 11213, 122, 11528,11235, 11233, 11749, 12108, 168,159, 13384, 12229, 12279, 10669,10050, 10053, 13360, 170, 10554,11367, 11414, 12528, 10935, 11146,11227, 10961, 10790, 11265, 283,10930, 11138, 12114, 11256, 371,778, 704, 162, 11237, 11232,214, 11017, 11238, 11186, 224,11750, 11244, 11245, 12535, 12536,12537, 12680, 31, 11248, 11243,11242, 11116, 468, 12117, 11249,11250, 11253, 12132, 290, 240,11257, 334, 11259, 428, 443,10055, 11262, 11266, 11269, 11270,13157, 11273, 11276, 11277, 226,11274, 268, 345, 11859, 33,12383, 12359, 12379, 218, 257,288, 460, 435]
          }
        }
      ]
    }
  }
}
{% endhighlight %}



### Chercher tous les documents pour lesquels un champ existe

{% highlight json %}
GET cambridge-v2/article/_search
{
  "query": {
    "filtered": {
      "filter": {
        "exists": {
          "field": "emails"
        }
      }
    }
  }
}
{% endhighlight %}
